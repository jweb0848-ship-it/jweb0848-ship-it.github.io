<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cuestionario de Programación Web (¡FINALMENTE CORREGIDO!)</title>
    <style>
        /* --- ESTILOS (Sin cambios en la apariencia) --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #e9ecef;
            color: #343a40;
            display: flex;
            justify-content: center;
        }
        .quiz-container {
            width: 100%;
            max-width: 900px;
            margin: auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #007bff;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        fieldset {
            border: 1px solid #dee2e6;
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 8px;
            background-color: #f8f9fa;
            position: relative;
        }
        legend {
            font-size: 1.3em;
            font-weight: 600;
            color: #495057;
            padding: 0 10px;
            margin-left: -10px;
        }
        .question-group label {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            padding: 8px 0;
            transition: background-color 0.2s;
            cursor: pointer;
        }
        .question-group label:hover {
            background-color: #e2e6ea;
            border-radius: 4px;
        }
        input[type="radio"], input[type="checkbox"] {
            margin-right: 15px;
            transform: scale(1.2);
        }
        input[type="text"] {
            width: 98%;
            padding: 10px;
            margin-top: 10px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 1em;
        }
        .submit-container {
            display: flex;
            justify-content: center;
            margin-top: 30px;
        }
        button[type="submit"] {
            background-color: #28a745;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }
        button[type="submit"]:hover {
            background-color: #218838;
        }
        #result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 6px;
            font-size: 1.2em;
            font-weight: bold;
            display: none;
        }
        .passed { background-color: #d4edda; color: #155724; }
        .failed { background-color: #f8d7da; color: #721c24; }
        .feedback {
            font-size: 0.9em;
            font-weight: bold;
            padding: 5px;
            border-radius: 4px;
            margin-top: 10px;
            text-align: center;
        }
        .correct {
            border-left: 5px solid #28a745;
            background-color: #e6ffed;
        }
        .incorrect {
            border-left: 5px solid #dc3545;
            background-color: #fce7e8;
        }
        .is-correct {
            font-weight: bold;
            color: #28a745;
            border-bottom: 1px dashed #28a745;
        }
        .disabled-after-submit {
            pointer-events: none;
            opacity: 0.8;
        }
        .missing-answer {
             border: 2px solid #dc3545 !important;
        }
    </style>
</head>
<body>

    <div class="quiz-container">
        <h1>Cuestionario: Fundamentos de Programación Web</h1>
        <p>Responde las siguientes 10 preguntas. Tu calificación y la retroalimentación se mostrarán al enviar.</p>

        <form id="quizForm">

            <fieldset data-q-type="radio" data-q-name="q1" data-correct-val="b">
                <legend>Pregunta 1/10 (Selección Única)</legend>
                <p>¿Cuál es el propósito principal de HTML en el desarrollo web?</p>
                <div class="question-group">
                    <label><input type="radio" name="q1" value="a" required> a) Controlar el diseño, los colores y las fuentes.</label>
                    <label><input type="radio" name="q1" value="b" required> b) Establecer la estructura y el contenido semántico de la página web.</label>
                    <label><input type="radio" name="q1" value="c" required> c) Definir la lógica de la aplicación y la interacción del usuario.</label>
                    <label><input type="radio" name="q1" value="d" required> d) Gestionar las consultas a la base de datos en el servidor.</label>
                    <div class="feedback"></div>
                </div>
            </fieldset>

            <fieldset data-q-type="radio" data-q-name="q2" data-correct-val="c">
                <legend>Pregunta 2/10 (Selección Única)</legend>
                <p>¿Qué técnica de CSS se utiliza para aplicar estilos diferentes basándose en las características del dispositivo (ancho de pantalla)?</p>
                <div class="question-group">
                    <label><input type="radio" name="q2" value="a" required> a) Transiciones CSS</label>
                    <label><input type="radio" name="q2" value="b" required> b) Flexbox Layout</label>
                    <label><input type="radio" name="q2" value="c" required> c) Media Queries (Consultas de Medios)</label>
                    <label><input type="radio" name="q2" value="d" required> d) Selectores de Clase Avanzados</label>
                    <div class="feedback"></div>
                </div>
            </fieldset>

            <fieldset data-q-type="radio" data-q-name="q3" data-correct-val="b">
                <legend>Pregunta 3/10 (Selección Única)</legend>
                <p>¿Qué objeto de JavaScript permite acceder y modificar el contenido, la estructura y los estilos de un documento HTML?</p>
                <div class="question-group">
                    <label><input type="radio" name="q3" value="a" required> a) El objeto Window</label>
                    <label><input type="radio" name="q3" value="b" required> b) El Document Object Model (DOM)</label>
                    <label><input type="radio" name="q3" value="c" required> c) El objeto Server</label>
                    <label><input type="radio" name="q3" value="d" required> d) El objeto Global</label>
                    <div class="feedback"></div>
                </div>
            </fieldset>

            <fieldset data-q-type="radio" data-q-name="q4" data-correct-val="b">
                <legend>Pregunta 4/10 (Selección Única)</legend>
                <p>¿Dónde se ejecuta típicamente el código de Frontend y Backend, respectivamente?</p>
                <div class="question-group">
                    <label><input type="radio" name="q4" value="a" required> a) Frontend en el servidor; Backend en el navegador.</label>
                    <label><input type="radio" name="q4" value="b" required> b) Frontend en el navegador del usuario; Backend en el servidor.</label>
                    <label><input type="radio" name="q4" value="c" required> c) Ambos se ejecutan en el servidor.</label>
                    <label><input type="radio" name="q4" value="d" required> d) Ambos se ejecutan en el navegador.</label>
                    <div class="feedback"></div>
                </div>
            </fieldset>

            <fieldset data-q-type="radio" data-q-name="q5" data-correct-val="a">
                <legend>Pregunta 5/10 (Selección Única)</legend>
                <p>¿Qué método HTTP se utiliza generalmente para enviar datos nuevos a un servidor con el fin de crear un nuevo recurso?</p>
                <div class="question-group">
                    <label><input type="radio" name="q5" value="a" required> a) POST</label>
                    <label><input type="radio" name="q5" value="b" required> b) GET</label>
                    <label><input type="radio" name="q5" value="c" required> c) DELETE</label>
                    <label><input type="radio" name="q5" value="d" required> d) PUT</label>
                    <div class="feedback"></div>
                </div>
            </fieldset>

            <fieldset data-q-type="radio" data-q-name="q6" data-correct-val="d">
                <legend>Pregunta 6/10 (Selección Única)</legend>
                <p>¿Cuál es la característica principal que define a una base de datos Relacional (SQL)?</p>
                <div class="question-group">
                    <label><input type="radio" name="q6" value="a" required> a) Utiliza JavaScript para manipular los datos.</label>
                    <label><input type="radio" name="q6" value="b" required> b) Almacena datos típicamente en documentos JSON (NoSQL).</label>
                    <label><input type="radio" name="q6" value="c" required> c) Es ideal para Big Data sin estructura.</label>
                    <label><input type="radio" name="q6" value="d" required> d) Almacena datos en tablas con esquemas fijos y relaciones.</label>
                    <div class="feedback"></div>
                </div>
            </fieldset>

            <fieldset data-q-type="radio" data-q-name="q7" data-correct-val="a">
                <legend>Pregunta 7/10 (Selección Única)</legend>
                <p>¿Cuál de los siguientes es un principio esencial de la arquitectura de una API REST?</p>
                <div class="question-group">
                    <label><input type="radio" name="q7" value="a" required> a) Sin Estado (Stateless): el servidor no guarda información de la sesión.</label>
                    <label><input type="radio" name="q7" value="b" required> b) Utiliza el protocolo SOAP y XML para la comunicación.</label>
                    <label><input type="radio" name="q7" value="c" required> c) Acoplamiento Fuerte (Tight Coupling) entre componentes.</label>
                    <label><input type="radio" name="q7" value="d" required> d) Mantiene sesiones persistentes con cada cliente.</label>
                    <div class="feedback"></div>
                </div>
            </fieldset>

            <fieldset data-q-type="radio" data-q-name="q8" data-correct-val="b">
                <legend>Pregunta 8/10 (Selección Única)</legend>
                <p>En el contexto de Git, ¿cuál es el propósito de un commit?</p>
                <div class="question-group">
                    <label><input type="radio" name="q8" value="a" required> a) Enviar los cambios al repositorio remoto (`push`).</label>
                    <label><input type="radio" name="q8" value="b" required> b) Crear una instantánea (snapshot) de los cambios en el historial local.</label>
                    <label><input type="radio" name="q8" value="c" required> c) Fusionar dos ramas de desarrollo (`merge`).</label>
                    <label><input type="radio" name="q8" value="d" required> d) Descargar código del repositorio remoto (`pull`).</label>
                    <div class="feedback"></div>
                </div>
            </fieldset>

            <fieldset data-q-type="text" data-q-name="q9_text" data-correct-val="DJANGO,FLASK">
                <legend>Pregunta 9/10 (Respuesta Escrita)</legend>
                <p>Menciona un popular framework de backend de pila completa (full-stack) basado en el lenguaje Python.</p>
                <div class="question-group">
                    <label for="q9_text">Respuesta:</label>
                    <input type="text" id="q9_text" name="q9_text" placeholder="Escribe tu respuesta aquí" required>
                    <div class="feedback"></div>
                </div>
            </fieldset>

            <fieldset data-q-type="text" data-q-name="q10_text" data-correct-val="MOTOR DE RENDERIZADO,RENDERING ENGINE,MOTOR DE RENDERIZACION">
                <legend>Pregunta 10/10 (Respuesta Escrita)</legend>
                <p>¿Qué nombre recibe el componente principal de un navegador web encargado de analizar y dibujar (renderizar) el código HTML y CSS en la pantalla?</p>
                <div class="question-group">
                    <label for="q10_text">Respuesta:</label>
                    <input type="text" id="q10_text" name="q10_text" placeholder="Escribe tu respuesta aquí" required>
                    <div class="feedback"></div>
                </div>
            </fieldset>

            <div class="submit-container">
                <button type="submit" id="submitButton">Enviar Cuestionario</button>
            </div>
        </form>

        <div id="result"></div>
    </div>

<script>
    // --- LÓGICA DE CALIFICACIÓN Y VALIDACIÓN CON JAVASCRIPT ---

    const quizForm = document.getElementById('quizForm');
    const resultDiv = document.getElementById('result');
    const submitButton = document.getElementById('submitButton');
    const fieldsets = document.querySelectorAll('fieldset');

    // Función auxiliar para normalizar respuestas de texto
    const normalizeText = (text) => text.toUpperCase().trim().replace(/[áÁ]/g, 'A').replace(/[éÉ]/g, 'E').replace(/[íÍ]/g, 'I').replace(/[óÓ]/g, 'O').replace(/[úÚ]/g, 'U');

    // ----------------------------------------------------
    // FUNCIÓN DE CALIFICACIÓN Y RETROALIMENTACIÓN
    // ----------------------------------------------------
    function gradeAndProvideFeedback(e) {
        e.preventDefault();

        let score = 0;
        const totalQuestions = fieldsets.length;
        let isFormValid = true;

        // Validar campos requeridos antes de procesar
        fieldsets.forEach(fieldset => {
            const qType = fieldset.dataset.qType;
            const qName = fieldset.dataset.qName;
            let answered = false;

            if (qType === 'radio') {
                if (quizForm.querySelector(`input[name="${qName}"]:checked`)) answered = true;
            } else if (qType === 'text') {
                if (quizForm.querySelector(`input[name="${qName}"]`).value.trim() !== '') answered = true;
            }

            if (!answered) {
                isFormValid = false;
                fieldset.classList.add('missing-answer');
            } else {
                fieldset.classList.remove('missing-answer');
            }
        });
        
        if (!isFormValid) {
            alert("¡Atención! Hay preguntas sin responder. Por favor, revisa los campos marcados en rojo.");
            return;
        }

        // Bloquear el formulario después de pasar la validación
        quizForm.classList.add('disabled-after-submit');
        submitButton.disabled = true;

        fieldsets.forEach(fieldset => {
            const qType = fieldset.dataset.qType;
            const qName = fieldset.dataset.qName;
            const correctValuesStr = fieldset.dataset.correctVal;
            const feedbackDiv = fieldset.querySelector('.feedback');
            let isCorrect = false;
            let primaryCorrectAnswer = correctValuesStr.split(',')[0]; // Siempre tomamos la primera opción como referencia para mostrar

            // Limpiar estilos y contenido de retroalimentación
            feedbackDiv.textContent = "";
            feedbackDiv.className = "feedback";
            fieldset.querySelectorAll('.is-correct').forEach(el => el.classList.remove('is-correct'));

            // 1. Preguntas de Radio (Selección Única)
            if (qType === 'radio') {
                const selected = quizForm.querySelector(`input[name="${qName}"]:checked`);
                if (selected && selected.value === correctValuesStr) {
                    isCorrect = true;
                }
                
                // Marcar la opción correcta
                fieldset.querySelectorAll('label').forEach(label => {
                    if (label.querySelector('input').value === correctValuesStr) {
                        label.classList.add('is-correct');
                    }
                });

            // 2. Preguntas de Texto (Respuesta Escrita) - CORRECCIÓN CLAVE AQUÍ
            } else if (qType === 'text') {
                const textInput = quizForm.querySelector(`input[name="${qName}"]`);
                const userAnswer = normalizeText(textInput.value);
                const correctTextOptions = correctValuesStr.split(',').map(normalizeText);

                if (correctTextOptions.includes(userAnswer)) {
                    isCorrect = true;
                }
            }

            // Aplicar retroalimentación visual y contar el puntaje
            if (isCorrect) {
                score++;
                feedbackDiv.textContent = "¡Correcto! ✅";
                feedbackDiv.classList.add('correct');
            } else {
                // Si es incorrecto, mostrar el error
                feedbackDiv.classList.add('incorrect');
                
                if (qType === 'text') {
                    // CORRECCIÓN: Usar innerHTML para que el navegador interprete el <span>
                    feedbackDiv.innerHTML = `Incorrecto. ❌ Respuesta correcta: <span class="is-correct">${primaryCorrectAnswer}</span>`;
                } else {
                    feedbackDiv.textContent = "Incorrecto. ❌";
                }
            }
        });

        // Mostrar el resultado final
        resultDiv.textContent = `Tu calificación final es: ${score} de ${totalQuestions}`;
        resultDiv.className = (score >= 7) ? 'passed' : 'failed';
        resultDiv.style.display = 'block';
        window.scrollTo(0, document.body.scrollHeight);
    }

    quizForm.addEventListener('submit', gradeAndProvideFeedback);
</script>

</body>
</html>